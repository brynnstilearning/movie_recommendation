# Movie Recommendation System: KNN vs Decision Tree Regressor

[![Python Version](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Dataset](https://img.shields.io/badge/dataset-MovieLens%20100K-orange.svg)](https://grouplens.org/datasets/movielens/)

Sistem rekomendasi film sederhana yang membandingkan performa algoritma **K-Nearest Neighbors (KNN)** dan **Decision Tree Regressor** menggunakan dataset MovieLens 100K.

## ğŸ“‹ Deskripsi

Penelitian ini mengimplementasikan dan membandingkan dua algoritma machine learning klasik untuk sistem rekomendasi film:
- **K-Nearest Neighbors (KNN)** dengan user-based collaborative filtering
- **Decision Tree Regressor** dengan feature engineering

### Hasil Utama
- **Decision Tree Regressor** mengungguli KNN pada 5 dari 6 metrik evaluasi
- RMSE: **0.9416** (DT) vs **0.9565** (KNN)
- F1-Score: **0.5371** (DT) vs **0.4929** (KNN)
- Feature aggregate rating berkontribusi **91.56%** terhadap akurasi prediksi

## ğŸ¯ Fitur

- âœ… Implementasi KNN dengan hyperparameter optimization
- âœ… Implementasi Decision Tree Regressor dengan pruning
- âœ… Feature engineering komprehensif (27 fitur)
- âœ… Evaluasi menggunakan 6 metrik (Precision, Recall, F1-Score, RMSE, MAE, Training Time)
- âœ… Visualisasi hasil (confusion matrix, learning curves, feature importance)
- âœ… Grid Search Cross-Validation untuk optimasi parameter
- âœ… Prototipe web application dengan Flask

## ğŸ—‚ï¸ Struktur Repository

```
movie_recommendation/
â”œâ”€â”€ README.md                      # Dokumentasi utama
â”œâ”€â”€ movie_recommendation.py        # Script utama sistem rekomendasi
â”œâ”€â”€ experiment_summary.txt         # Ringkasan hasil eksperimen
â”œâ”€â”€ eda_analysis.png              # Visualisasi Exploratory Data Analysis
â”œâ”€â”€ actual_vs_predicted.png       # Scatter plot perbandingan prediksi
â”œâ”€â”€ feature_importance.png        # Grafik feature importance
â”œâ”€â”€ learning_curves.png           # Learning curves kedua model
â”œâ”€â”€ prediction_distribution.png   # Distribusi prediksi
â”œâ”€â”€ label_encoding.pkl            # Label encoder tersimpan
â”œâ”€â”€ scaler.pkl                    # StandardScaler tersimpan
â”œâ”€â”€ knn_model.pkl                 # Model KNN trained
â”œâ”€â”€ dt_model.pkl                  # Model Decision Tree trained
â”œâ”€â”€ model_comparison_results.csv  # Hasil perbandingan metrik
â”œâ”€â”€ model_comparison_results.png  # Visualisasi perbandingan
â”œâ”€â”€ u.data                        # Rating data (100,000 ratings)
â”œâ”€â”€ u.genre                       # Genre list
â”œâ”€â”€ u.info                        # Dataset information
â”œâ”€â”€ u.item                        # Movie information
â”œâ”€â”€ u.occupation                  # Occupation list
â”œâ”€â”€ u.user                        # User demographics
â”œâ”€â”€ u1.base - u5.base            # Training sets (cross-validation)
â”œâ”€â”€ u1.test - u5.test            # Testing sets (cross-validation)
â”œâ”€â”€ ua.base, ua.test             # Additional split A
â””â”€â”€ ub.base, ub.test             # Additional split B
```

## ğŸš€ Quick Start

### Prerequisites

- Python 3.8 atau lebih tinggi
- pip (Python package manager)
- Git

### Instalasi

1. **Clone repository**
```bash
git clone https://github.com/brynnstilearning/movie_recommendation.git
cd movie_recommendation
```

2. **Buat virtual environment (recommended)**
```bash
python -m venv venv

# Aktivasi di Windows
venv\Scripts\activate

# Aktivasi di Linux/Mac
source venv/bin/activate
```

3. **Install dependencies**
```bash
pip install -r requirements.txt
```

4. **Dataset sudah included!**
Dataset MovieLens 100K sudah tersedia di repository (file u.data, u.item, u.user, dll)

## ğŸ“Š Dataset

**MovieLens 100K** berisi:
- **100,000 ratings** (skala 1-5)
- **943 pengguna**
- **1,682 film**
- **Sparsity: 93.70%**
- Periode: September 1997 - April 1998

### Struktur Data

**u.data** (ratings):
```
user_id | item_id | rating | timestamp
```

**u.item** (movies):
```
movie_id | title | release_date | video_release_date | IMDb_URL | genres
```

**u.user** (users):
```
user_id | age | gender | occupation | zip_code
```

## ğŸ’» Usage

### 1. Menjalankan Sistem Rekomendasi Lengkap

Script utama yang mengandung semua fungsionalitas:

```bash
python movie_recommendation.py
```

Script ini akan:
- Load dan preprocess dataset MovieLens 100K
- Melakukan Exploratory Data Analysis (EDA)
- Training model KNN dan Decision Tree Regressor
- Hyperparameter optimization dengan Grid Search CV
- Evaluasi dan perbandingan kedua model
- Generate visualisasi hasil
- Save trained models (.pkl)

### 2. Menggunakan Trained Models

```python
import pickle
import pandas as pd

# Load trained models
with open('knn_model.pkl', 'rb') as f:
    knn_model = pickle.load(f)

with open('dt_model.pkl', 'rb') as f:
    dt_model = pickle.load(f)

# Load preprocessors
with open('scaler.pkl', 'rb') as f:
    scaler = pickle.load(f)

with open('label_encoding.pkl', 'rb') as f:
    label_encoders = pickle.load(f)

# Prediksi rating untuk user dan movie tertentu
# (implementasi detail tergantung struktur data Anda)
user_id = 196
movie_id = 242

# Untuk KNN (collaborative filtering)
predicted_rating_knn = knn_model.predict(user_id, movie_id)

# Untuk Decision Tree (dengan features)
features = prepare_features(user_id, movie_id)  # sesuaikan dengan fungsi Anda
predicted_rating_dt = dt_model.predict(features)

print(f"KNN Prediction: {predicted_rating_knn:.2f}")
print(f"Decision Tree Prediction: {predicted_rating_dt:.2f}")
```

### 3. Melihat Hasil Eksperimen

Hasil eksperimen sudah tersimpan dalam repository:

**Visualisasi:**
- `eda_analysis.png` - Analisis eksplorasi data
- `actual_vs_predicted.png` - Perbandingan prediksi vs aktual
- `feature_importance.png` - Importance setiap feature
- `learning_curves.png` - Learning curves kedua model
- `prediction_distribution.png` - Distribusi prediksi
- `model_comparison_results.png` - Perbandingan metrik

**Data:**
- `experiment_summary.txt` - Ringkasan hasil penelitian
- `model_comparison_results.csv` - Metrik evaluasi dalam format CSV

### 4. Cross-Validation

Dataset sudah menyediakan 5-fold cross-validation splits:

```python
# Training set: u1.base, u2.base, u3.base, u4.base, u5.base
# Testing set: u1.test, u2.test, u3.test, u4.test, u5.test

# Untuk validasi tambahan
# Set A: ua.base (training), ua.test (testing)
# Set B: ub.base (training), ub.test (testing)
```

## ğŸ“ˆ Hasil Penelitian

### Perbandingan Metrik

| Metrik | KNN | Decision Tree | Pemenang |
|--------|-----|---------------|----------|
| **Precision** | 0.8332 | **0.8393** | DT âœ“ |
| **Recall** | 0.3500 | **0.3949** | DT âœ“ |
| **F1-Score** | 0.4929 | **0.5371** | DT âœ“ |
| **RMSE** | 0.9565 | **0.9416** | DT âœ“ |
| **MAE** | 0.7615 | **0.7428** | DT âœ“ |
| **Training Time** | **12.58s** | 18.12s | KNN âœ“ |

### Hyperparameter Optimal

**KNN:**
- n_neighbors: 30
- weights: 'distance'
- metric: 'euclidean'

**Decision Tree Regressor:**
- max_depth: 10
- min_samples_split: 20
- min_samples_leaf: 5
- criterion: 'squared_error'

### Feature Importance (Top 5)

1. **movie_avg_rating**: 55.43%
2. **user_avg_rating**: 36.13%
3. **user_id**: 2.29%
4. **age**: 1.81%
5. **movie_id**: 1.29%

## ğŸ”¬ Metodologi

Penelitian menggunakan framework **CRISP-DM**:

1. **Business Understanding**: Identifikasi masalah information overload
2. **Data Understanding**: EDA pada MovieLens 100K
3. **Data Preparation**: 
   - Feature engineering (27 fitur)
   - Train-test split (80-20)
   - Feature scaling dengan StandardScaler
4. **Modeling**: 
   - Grid Search Cross-Validation (5-fold)
   - Hyperparameter optimization
5. **Evaluation**: 
   - Metrik: Precision, Recall, F1-Score, RMSE, MAE
   - Threshold relevansi: rating â‰¥ 4
6. **Deployment**: Prototipe web application

## ğŸ“š Dependencies

Lihat `requirements.txt` untuk daftar lengkap. Dependencies utama:

```txt
numpy>=1.21.0
pandas>=1.3.0
scikit-learn>=0.24.0
matplotlib>=3.4.0
seaborn>=0.11.0
scipy>=1.7.0
```

Jika belum ada `requirements.txt`, buat dengan:

```bash
pip freeze > requirements.txt
```

Atau gunakan dependencies minimal:

```bash
pip install numpy pandas scikit-learn matplotlib seaborn scipy
```

## ğŸ¤ Contributing

Kontribusi sangat diterima! Silakan:

1. Fork repository ini
2. Buat branch baru (`git checkout -b feature/AmazingFeature`)
3. Commit perubahan (`git commit -m 'Add some AmazingFeature'`)
4. Push ke branch (`git push origin feature/AmazingFeature`)
5. Buat Pull Request

## ğŸ“ Citation

Jika menggunakan kode ini dalam penelitian, mohon cite:

```bibtex
@misc{anang2025movie,
  author = {Febriananto, Nur Muhammad Anang},
  title = {Analisis Kinerja Algoritma K-Nearest Neighbors dan Decision Tree Regressor untuk Sistem Rekomendasi Film Sederhana},
  year = {2025},
  institution = {UIN Maulana Malik Ibrahim Malang},
  url = {https://github.com/brynnstilearning/movie_recommendation}
}
```

## ğŸ“„ License

Distributed under the MIT License. See `LICENSE` for more information.

## ğŸ‘¤ Author

**Nur Muhammad Anang Febriananto**
- NIM: 230605110103
- Universitas: UIN Maulana Malik Ibrahim Malang
- Jurusan: Teknik Informatika
- Email: 230605110103@student.uin-malang.ac.id

## ğŸ™ Acknowledgments

- [GroupLens Research](https://grouplens.org/) untuk dataset MovieLens 100K
- [MovieLens Dataset](https://www.kaggle.com/datasets/prajitdatta/movielens-100k-dataset) di Kaggle
- Prof. Dr. H.MUHAMMAD FAISAL,S.Kom., M.T dan Fakultas Sains dan Teknologi UIN Malang
- Komunitas open-source Python dan scikit-learn

## ğŸ“ Contact & Support

Untuk pertanyaan, saran, atau issue:
- WA: 081252696114
- Email: 230605110103@student.uin-malang.ac.id

---

## ğŸ”— Links

- [Laporan Penelitian Lengkap](docs/laporan_penelitian.pdf)
- [Dataset MovieLens 100K](https://grouplens.org/datasets/movielens/100k/)
- [Dokumentasi API](docs/API.md)
- [Changelog](CHANGELOG.md)
